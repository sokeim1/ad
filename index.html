<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ Vibix</title>
    <style>
        body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; padding: 0; background: #0b1020; color: #fff; }
        .container { display: flex; gap: 16px; flex-direction: column; min-height: 100vh; align-items: center; justify-content: center; text-align: center; padding: 16px; }
        .loader { width: 56px; height: 56px; border-radius: 50%; border: 6px solid rgba(255,255,255,0.18); border-top-color: #4f8cff; animation: spin 1s linear infinite; margin: 12px auto; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .btn { background: #4f8cff; color: #fff; padding: 12px 16px; border-radius: 10px; text-decoration: none; font-weight: 600; display: inline-block; }
        .frame { width: min(100%, 960px); aspect-ratio: 16/9; border: 0; border-radius: 12px; box-shadow: 0 8px 40px rgba(0,0,0,0.35); background: #000; }
        .note { opacity: .8; font-size: 14px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìΩÔ∏è –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ</h1>
        <div class="loader" id="loader"></div>
        <p id="status">–ó–∞–≥—Ä—É–∂–∞–µ–º –ø–ª–µ–µ—Ä...</p>
        <iframe id="player" class="frame" allowfullscreen referrerpolicy="no-referrer"></iframe>
        <p class="note">–ï—Å–ª–∏ –ø–ª–µ–µ—Ä –Ω–µ –æ—Ç–∫—Ä—ã–ª—Å—è, –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ.</p>
        <a id="openBtn" class="btn" href="#" target="_blank" rel="noopener">–û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ</a>
    </div>

    <script type="text/javascript" src="https://v-js-menu.run/public/lib.en.min.js"></script>
    <ins id="vibix_union" data-publisher_id="676077867" data-add_types="brand,sticker,pcsticker,banners"></ins>
    <script>
        function getParam(name) {
            const url = new URL(window.location.href);
            return url.searchParams.get(name);
        }
        function getAllParam(name) {
            const url = new URL(window.location.href);
            return url.searchParams.getAll(name);
        }
        const iframeUrl = getParam('iframe');
        const kp = getParam('kp');
        const imdb = getParam('imdb');
        const season = getParam('season');
        const voiceover = getParam('voiceover');
        const episodes = getAllParam('episode[]');

        function buildUrl(base) {
            const params = [];
            if (season) params.push(`season=${encodeURIComponent(season)}`);
            if (Array.isArray(episodes)) {
                episodes.forEach(e => params.push(`episode[]=${encodeURIComponent(e)}`));
            }
            if (voiceover) params.push(`voiceover=${encodeURIComponent(voiceover)}`);
            if (!params.length) return base;
            const sep = base.includes('?') ? '&' : '?';
            return base + sep + params.join('&');
        }

        async function init() {
            try {
                let url = iframeUrl;
                if (!url && kp) url = `https://vibix.org/embed-kp/${encodeURIComponent(kp)}`;
                if (!url && imdb) url = `https://vibix.org/embed-imdb/${encodeURIComponent(imdb)}`;
                if (!url) throw new Error('no_source');
                url = buildUrl(url);
                const frame = document.getElementById('player');
                frame.src = url;
                document.getElementById('openBtn').href = url;
                document.getElementById('status').textContent = '–ü–ª–µ–µ—Ä –∑–∞–≥—Ä—É–∂–µ–Ω';
            } catch (e) {
                document.getElementById('status').textContent = '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–ª–µ–µ—Ä';
            } finally {
                document.getElementById('loader').style.display = 'none';
            }
        }
        init();
    </script>
</body>
</html>

